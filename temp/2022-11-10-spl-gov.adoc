= SPL Governance tech details deep dive
chalda <ondrej.chaloupka@proton.me>
1.0, 2022-11-10

:page-template: post
:page-draft: true
:page-slug: spl-governance
:page-category:
:page-tags: Rust, Solana, DAO
:page-description: Technical details on how SPL Governance program works in version 3.0.
:page-socialImage:

If you attented the Breakpoint you can learn Marinade cooks its part in the SPL Governance project.
Our goal is to contribute the ecosystem several enhancements. Within others it's delegated voting,
weighted vote type and proposal options ennahcements.

image::articles/spl-gov-breakpoint.png[]

This article will give you a technical deep-dive of the SPL GOV program in it's current version `3.0`.

== SPL Governance program

The SPL governance program can be observed in https://github.com/solana-labs/solana-program-library/tree/master/governance[Solana Program Library].
The TypeScript SDK is under https://github.com/solana-labs/oyster/tree/main/packages/governance-sdk[Oyster project].
The GUI is baked at https://github.com/solana-labs/governance-ui[Governance UI project] and the live version
of the mainnet DAO projects is available at https://app.realms.today/realms.

== SPL Governance account structure

The Governance account structure is documented
https://github.com/solana-labs/solana-program-library/tree/da05275176f69bd158fccefed0076ddc5a7973ee/governance#program-accounts[at Github] (at this time).

image::articles/spl-gov-governance-accounts.jpg

From the high level point of view the SPL Governance works with Realm structure that represents a DAO.
Currently it's the data struct
https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/realm.rs#L128[`RealmV2`].
The Realm
https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/realm.rs#L35[configures]
some fundamentals for the DAO voting.
That's the community token covering the DAO, which DAO considers a council to exist and vote or it's whole run as community voting,
it defines who can create a new governance account and it defines how the
https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/realm_config.rs#L24[type of token is counted].
Realm consists few or more `Governance` accounts (
https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/governance.rs#L64[`GovernanceV2`]
data structure)
The Governance is a structural bundle that keeps configuration for the proposals created under it.
The https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/governance.rs#L25[governance configuration] defines for example, who can create a new proposal, if the proposals will be voted by council, community or both,
what is max time for voting on the proposal,
how https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/enums.rs#L145[the votes are resolved] at the end of voting and other you can check in code.
Then we have the Proposal (data struct
https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/proposal.rs#L108[`ProposalV2`]
) that the community (or/and council) votes on.
The created Proposal consists of several options to vote for and optionally transactions that are executed when the particular proposal
option passed sucessfully with voting.
The Proposal itself then track the time of active voting is permitted to run, what is weight of tokens involved in voting,
if veto voting is enabled, how options are considered https://github.com/solana-labs/solana-program-library/blob/da05275176f69bd158fccefed0076ddc5a7973ee/governance/program/src/state/proposal.rs#L57[as types] and similar.
Every option that's under Proposal is identified by a label, has got a vote result state and considers transactions to be executed on its behalf.

==
